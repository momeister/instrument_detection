import librosa
import numpy as np

wav_file_path = 'testklavier.mp3'

# Wav-Datei einlesen
audio_data, sr = librosa.load(wav_file_path)

# Berechnen der Short-Time Fourier Transform (STFT) mit einer Auflösung von 256*2 Frequenzbändern
stft_data = librosa.stft(audio_data, n_fft=256*2)

# Analysieren der Obertonreihe
frequencies = librosa.fft_frequencies(sr=sr)[:len(stft_data[0])]  # Frequenzen für ein Zeitfenster
magnitudes = librosa.amplitude_to_db(abs(stft_data))

# Schwellenwerte definieren
lower_threshold = 10  # Schwellenwert für die Klassifizierung als Violine
upper_threshold = 30  # Schwellenwert für die Klassifizierung als Klavier

# Durchschnittliche Amplitude über alle Frequenzen berechnen
average_amplitude = np.mean(magnitudes, axis=1)

# Klassifizieren
if np.max(average_amplitude) < lower_threshold:
    instrument = 'Violine'
elif np.max(average_amplitude) > upper_threshold:
    instrument = 'Klavier'
else:
    instrument = 'Unbekannt'

# Ausgabe des Ergebnisses
print(f'Instrument: {instrument}')
